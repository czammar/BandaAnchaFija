if_else(df$REG_SOCIOECONOM[index]=="Noreste",3,
if_else(df$REG_SOCIOECONOM[index]=="Noroeste",4,
if_else(df$REG_SOCIOECONOM[index]=="Occidente",5,
if_else(df$REG_SOCIOECONOM[index]=="Oriente",6,
if_else(df$REG_SOCIOECONOM[index]=="Sureste",7,8)))))
}
for (index in 1:nrow(df)){
df$REG_SOCIOECONOM[index] <- if_else(df$REG_SOCIOECONOM[index]=="Centronorte",1,
if_else(df$REG_SOCIOECONOM[index]=="Centrosur",2,
if_else(df$REG_SOCIOECONOM[index]=="Noreste",3,
if_else(df$REG_SOCIOECONOM[index]=="Noroeste",4,
if_else(df$REG_SOCIOECONOM[index]=="Occidente",5,
if_else(df$REG_SOCIOECONOM[index]=="Oriente",6,
if_else(df$REG_SOCIOECONOM[index]=="Sureste",7,8)))))))
}
View(df)
unique(df$PEN_CLASS)
df %>% select(PO2SM,IM,INFRA_INDEX,NUM_OPS,PEN_BAF_COAXFO,DENS_HOGS,REG_SOCIOECONOM)
library(readr)
library(tidyverse)
library(readxl)
# Establece directorio de trabajo
setwd("/media/Box/Aprendizaje_Maquina/Projecto")
# Crear las bases de datos para trabajar
source("creating_baf.R") # Accesos de banda ancha fija a junio/2019 BIT del IFT
source("creating_conapo.R") # Indice marginacion y porcentaje pob con menos de 2 salarios min, 2015 CONAPO
source("creating_inafed.R") # Superficie de municipios, INAFED
source("creating_indiceinfraestructura.R")  # Indice infraestructura TII - centro de estudios IFT
source("creating_hogares.R") # Hogares por municipios Encuesta intercensal 2015, INEGI
source("creating_poblacion.R") # Poblacion por municipios Encuesta intercensal 2015, INEGI
# Elimina variables auxiliares
rm(index, left_path,name_state,right_path,states_list,cleaning_hog_state,cleaning_pop_state)
# Consolidamos las bases
df <- left_join(hogares2015,poblacion2015, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,conapo, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,INAFED, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,infraestructura_index, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,BAF_062019, by = "K_ENTIDAD_MUNICIPIO")
# Se eliminan columas sin interes para el analisis
df$K_ENTIDAD<-NULL
df$K_MUNICIPIO<-NULL
df$ANIO<-NULL
df$MES<-NULL
## El detalle de accesos a nivel municipal con NA se imputa con cero
df <- df %>% mutate_all(~replace(., is.na(.), 0))
# Crea variable de penetracion de BAF por cada 100 hogares y la penetracion de cable coaxial + fibra optica
df <- df %>% mutate(PEN_BAF = df$ALL_ACCESS/df$HOGARES*100)
df <- df %>% mutate(PEN_BAF_COAXFO = df$COAX_FO/df$HOGARES*100)
# Crea variable de densidad de hogares por kilometros cuadrados
df <- df %>% mutate(DENS_HOGS = df$HOGARES/df$SUPERFICIE)
# Creamos una columna para clasificar los municipios segun su grado de penetracion.
#La clasificación de Penetracion de Fibra Óptica y Cable Coaxial:
# Sin cobertura=0
# Muy baja 0>25%
# Baja 25%>50%
# Media 50%>75%
# Alta 75%>100%
# Muy Alta 100%
df$PEN_CLASS <- NA
for (index in 1:nrow(df)){
df$PEN_CLASS[index] <- if_else(df$PEN_BAF_COAXFO[index]==0,0,
if_else(df$PEN_BAF_COAXFO[index]<=25,1,
if_else(df$PEN_BAF_COAXFO[index]<=50,2,
if_else(df$PEN_BAF_COAXFO[index]<=75,3,
if_else(df$PEN_BAF_COAXFO[index]<=100,4,5)))))
}
#----- Agregamos una columna que nos diga la region socioecnomica a la que pertenece el municipio
RegionesSocioEcono <- read_csv("RegionesSocioEcono.csv",
col_types = cols(NOM_ABRE_ENTIDAD = col_skip(),
NOM_ENTIDAD = col_skip(), NUM = col_skip()))
df <- df %>% mutate(K_ENTIDAD = substr(K_ENTIDAD_MUNICIPIO,1,2))
df <- left_join(df,RegionesSocioEcono, by = "K_ENTIDAD")
df$K_ENTIDAD<-NULL
for (index in 1:nrow(df)){
df$REG_SOCIOECONOM[index] <- if_else(df$REG_SOCIOECONOM[index]=="Centronorte",1,
if_else(df$REG_SOCIOECONOM[index]=="Centrosur",2,
if_else(df$REG_SOCIOECONOM[index]=="Noreste",3,
if_else(df$REG_SOCIOECONOM[index]=="Noroeste",4,
if_else(df$REG_SOCIOECONOM[index]=="Occidente",5,
if_else(df$REG_SOCIOECONOM[index]=="Oriente",6,
if_else(df$REG_SOCIOECONOM[index]=="Sureste",7,8)))))))
}
df1 <- df %>% select(PO2SM,IM,INFRA_INDEX,NUM_OPS,PEN_BAF_COAXFO,DENS_HOGS,REG_SOCIOECONOM)
df1
mtcars.df1 <- prcomp(df1, center = TRUE,scale. = TRUE)
df1$REG_SOCIOECONOM<- as.numeric(df1$REG_SOCIOECONOM)
df1.pca <- prcomp(df1, center = TRUE,scale. = TRUE)
df1
df1$PO2SM<- as.numeric(df1$PO2SM)
df1.pca <- prcomp(df1, center = TRUE,scale. = TRUE)
View(df1)
x <- as.data.frame(abs(is.na(df)))
x
summary(x)
x <- as.data.frame(abs(is.na(df1)))
summary(x)
df1.pca <- prcomp(df1, center = TRUE,scale. = TRUE)
df1 <- df %>% select(as.numeric(PO2SM),IM,INFRA_INDEX,NUM_OPS,PEN_BAF_COAXFO,DENS_HOGS)
df1 <- df %>% select(PO2SM,IM,INFRA_INDEX,NUM_OPS,PEN_BAF_COAXFO,DENS_HOGS)
df1.pca <- prcomp(df1, center = TRUE,scale. = TRUE)
df1$PO2SM<- as.numeric(df1$PO2SM)
df1.pca <- prcomp(df1, center = TRUE,scale. = TRUE)
df1 <- df %>% select(PO2SM,IM,INFRA_INDEX,PEN_BAF_COAXFO,DENS_HOGS)
df1$PO2SM<- as.numeric(df1$PO2SM)
df1.pca <- prcomp(df1, center = TRUE,scale. = TRUE)
df1 <- df %>% select(PO2SM,IM,INFRA_INDEX,DENS_HOGS)
df1$PO2SM<- as.numeric(df1$PO2SM)
df1.pca <- prcomp(df1, center = TRUE,scale. = TRUE)
df1
cov(df1)
df1 <- df %>% select(PO2SM,IM,INFRA_INDEX,NUM_OPS,PEN_BAF_COAXFO,DENS_HOGS,REG_SOCIOECONOM)
cov(df1)
df1$PO2SM<- as.numeric(df1$PO2SM)
df1$REG_SOCIOECONOM<- as.numeric(df1$REG_SOCIOECONOM)
cov(df1)
glimpse(df1)
mean(df1$DENS_HOGS)
max(df1$DENS_HOGS)
plot(hogares2015$HOGARES)
plot(log(hogares2015$HOGARES))
min(hogares2015$HOGARES)
summary(df)
library(readr)
library(tidyverse)
library(readxl)
# Establece directorio de trabajo
setwd("/media/Box/Aprendizaje_Maquina/Projecto")
# Crear las bases de datos para trabajar
source("creating_baf.R") # Accesos de banda ancha fija a junio/2019 BIT del IFT
source("creating_conapo.R") # Indice marginacion y porcentaje pob con menos de 2 salarios min, 2015 CONAPO
source("creating_inafed.R") # Superficie de municipios, INAFED
source("creating_indiceinfraestructura.R")  # Indice infraestructura TII - centro de estudios IFT
source("creating_hogares.R") # Hogares por municipios Encuesta intercensal 2015, INEGI
source("creating_poblacion.R") # Poblacion por municipios Encuesta intercensal 2015, INEGI
# Elimina variables auxiliares
rm(index, left_path,name_state,right_path,states_list,cleaning_hog_state,cleaning_pop_state)
# Consolidamos las bases
df <- left_join(hogares2015,poblacion2015, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,conapo, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,INAFED, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,infraestructura_index, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,BAF_062019, by = "K_ENTIDAD_MUNICIPIO")
# Se eliminan columas sin interes para el analisis
df$K_ENTIDAD<-NULL
df$K_MUNICIPIO<-NULL
df$ANIO<-NULL
df$MES<-NULL
summary(df$HOGARES)
df <- df %>% mutate(PEN_BAF = df$ALL_ACCESS/df$HOGARES*100)
warnings()
df <- df %>% mutate(PEN_BAF = df$ALL_ACCESS/df$HOGARES*100)
df <- df %>% mutate(PEN_BAF_COAXFO = df$COAX_FO/df$HOGARES*100)
summary(df$PEN_BAF_COAXFO)
df <- df %>% mutate(PEN_BAF_COAXFO = 1/df$HOGARES*100)
summary(df$PEN_BAF_COAXFO)
for (i in 1:nrow(df)){
df$PEN_BAF_COAXFO[i]<- df$PEN_BAF_COAXFO[i]/df$HOGARES[i]*100
}
for (i in 1:nrow(df)){
df$PEN_BAF_COAXFO[i]<- df$PEN_BAF_COAXFO[i]/df$HOGARES[i]*100
}
summary(df$PEN_BAF_COAXFO)
library(readr)
library(tidyverse)
library(readxl)
# Establece directorio de trabajo
setwd("/media/Box/Aprendizaje_Maquina/Projecto")
# Crear las bases de datos para trabajar
source("creating_baf.R") # Accesos de banda ancha fija a junio/2019 BIT del IFT
source("creating_conapo.R") # Indice marginacion y porcentaje pob con menos de 2 salarios min, 2015 CONAPO
source("creating_inafed.R") # Superficie de municipios, INAFED
source("creating_indiceinfraestructura.R")  # Indice infraestructura TII - centro de estudios IFT
source("creating_hogares.R") # Hogares por municipios Encuesta intercensal 2015, INEGI
source("creating_poblacion.R") # Poblacion por municipios Encuesta intercensal 2015, INEGI
# Elimina variables auxiliares
rm(index, left_path,name_state,right_path,states_list,cleaning_hog_state,cleaning_pop_state)
# Consolidamos las bases
df <- left_join(hogares2015,poblacion2015, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,conapo, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,INAFED, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,infraestructura_index, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,BAF_062019, by = "K_ENTIDAD_MUNICIPIO")
# Se eliminan columas sin interes para el analisis
df$K_ENTIDAD<-NULL
df$K_MUNICIPIO<-NULL
df$ANIO<-NULL
df$MES<-NULL
## El detalle de accesos a nivel municipal con NA se imputa con cero
df <- df %>% mutate_all(~replace(., is.na(.), 0))
# Crea variable de penetracion de BAF por cada 100 hogares y la penetracion de cable coaxial + fibra optica
df <- df %>% mutate(PEN_BAF = df$ALL_ACCESS/df$HOGARES*100)
df$PEN_BAF_COAXFO <- NULL
for (i in 1:nrow(df)){
df$PEN_BAF_COAXFO[i]<- df$PEN_BAF_COAXFO[i]/df$HOGARES[i]*100
}
# Crea variable de densidad de hogares por kilometros cuadrados
df <- df %>% mutate(DENS_HOGS = df$HOGARES/df$SUPERFICIE)
# Creamos una columna para clasificar los municipios segun su grado de penetracion.
#La clasificación de Penetracion de Fibra Óptica y Cable Coaxial:
# Sin cobertura=0
# Muy baja 0>25%
# Baja 25%>50%
# Media 50%>75%
# Alta 75%>100%
# Muy Alta 100%
df$PEN_CLASS <- NA
for (index in 1:nrow(df)){
df$PEN_CLASS[index] <- if_else(df$PEN_BAF_COAXFO[index]==0,0,
if_else(df$PEN_BAF_COAXFO[index]<=25,1,
if_else(df$PEN_BAF_COAXFO[index]<=50,2,
if_else(df$PEN_BAF_COAXFO[index]<=75,3,
if_else(df$PEN_BAF_COAXFO[index]<=100,4,5)))))
}
#----- Agregamos una columna que nos diga la region socioecnomica a la que pertenece el municipio
RegionesSocioEcono <- read_csv("RegionesSocioEcono.csv",
col_types = cols(NOM_ABRE_ENTIDAD = col_skip(),
NOM_ENTIDAD = col_skip(), NUM = col_skip()))
df <- df %>% mutate(K_ENTIDAD = substr(K_ENTIDAD_MUNICIPIO,1,2))
df <- left_join(df,RegionesSocioEcono, by = "K_ENTIDAD")
df$K_ENTIDAD<-NULL
for (index in 1:nrow(df)){
df$REG_SOCIOECONOM[index] <- if_else(df$REG_SOCIOECONOM[index]=="Centronorte",1,
if_else(df$REG_SOCIOECONOM[index]=="Centrosur",2,
if_else(df$REG_SOCIOECONOM[index]=="Noreste",3,
if_else(df$REG_SOCIOECONOM[index]=="Noroeste",4,
if_else(df$REG_SOCIOECONOM[index]=="Occidente",5,
if_else(df$REG_SOCIOECONOM[index]=="Oriente",6,
if_else(df$REG_SOCIOECONOM[index]=="Sureste",7,8)))))))
}
df1 <- df %>% select(PO2SM,IM,INFRA_INDEX,NUM_OPS,PEN_BAF_COAXFO,DENS_HOGS,REG_SOCIOECONOM)
View(df)
df$PEN_BAF_COAXFO <- NULL
View(df)
df$PEN_BAF_COAXFO <- 0
df$PEN_BAF_COAXFO <- 0
View(df)
library(readr)
library(tidyverse)
library(readxl)
# Establece directorio de trabajo
setwd("/media/Box/Aprendizaje_Maquina/Projecto")
# Crear las bases de datos para trabajar
source("creating_baf.R") # Accesos de banda ancha fija a junio/2019 BIT del IFT
source("creating_conapo.R") # Indice marginacion y porcentaje pob con menos de 2 salarios min, 2015 CONAPO
source("creating_inafed.R") # Superficie de municipios, INAFED
source("creating_indiceinfraestructura.R")  # Indice infraestructura TII - centro de estudios IFT
source("creating_hogares.R") # Hogares por municipios Encuesta intercensal 2015, INEGI
source("creating_poblacion.R") # Poblacion por municipios Encuesta intercensal 2015, INEGI
# Elimina variables auxiliares
rm(index, left_path,name_state,right_path,states_list,cleaning_hog_state,cleaning_pop_state)
# Consolidamos las bases
df <- left_join(hogares2015,poblacion2015, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,conapo, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,INAFED, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,infraestructura_index, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,BAF_062019, by = "K_ENTIDAD_MUNICIPIO")
# Se eliminan columas sin interes para el analisis
df$K_ENTIDAD<-NULL
df$K_MUNICIPIO<-NULL
df$ANIO<-NULL
df$MES<-NULL
## El detalle de accesos a nivel municipal con NA se imputa con cero
df <- df %>% mutate_all(~replace(., is.na(.), 0))
# Crea variable de penetracion de BAF por cada 100 hogares y la penetracion de cable coaxial + fibra optica
df <- df %>% mutate(PEN_BAF = df$ALL_ACCESS/df$HOGARES*100)
df$PEN_BAF_COAXFO <- 0
for (i in 1:nrow(df)){
df$PEN_BAF_COAXFO[i]<- df$COAX_FO[i]/df$HOGARES[i]*100
}
# Crea variable de densidad de hogares por kilometros cuadrados
df <- df %>% mutate(DENS_HOGS = df$HOGARES/df$SUPERFICIE)
# Creamos una columna para clasificar los municipios segun su grado de penetracion.
#La clasificación de Penetracion de Fibra Óptica y Cable Coaxial:
# Sin cobertura=0
# Muy baja 0>25%
# Baja 25%>50%
# Media 50%>75%
# Alta 75%>100%
# Muy Alta 100%
df$PEN_CLASS <- NA
for (index in 1:nrow(df)){
df$PEN_CLASS[index] <- if_else(df$PEN_BAF_COAXFO[index]==0,0,
if_else(df$PEN_BAF_COAXFO[index]<=25,1,
if_else(df$PEN_BAF_COAXFO[index]<=50,2,
if_else(df$PEN_BAF_COAXFO[index]<=75,3,
if_else(df$PEN_BAF_COAXFO[index]<=100,4,5)))))
}
#----- Agregamos una columna que nos diga la region socioecnomica a la que pertenece el municipio
RegionesSocioEcono <- read_csv("RegionesSocioEcono.csv",
col_types = cols(NOM_ABRE_ENTIDAD = col_skip(),
NOM_ENTIDAD = col_skip(), NUM = col_skip()))
df <- df %>% mutate(K_ENTIDAD = substr(K_ENTIDAD_MUNICIPIO,1,2))
df <- left_join(df,RegionesSocioEcono, by = "K_ENTIDAD")
df$K_ENTIDAD<-NULL
for (index in 1:nrow(df)){
df$REG_SOCIOECONOM[index] <- if_else(df$REG_SOCIOECONOM[index]=="Centronorte",1,
if_else(df$REG_SOCIOECONOM[index]=="Centrosur",2,
if_else(df$REG_SOCIOECONOM[index]=="Noreste",3,
if_else(df$REG_SOCIOECONOM[index]=="Noroeste",4,
if_else(df$REG_SOCIOECONOM[index]=="Occidente",5,
if_else(df$REG_SOCIOECONOM[index]=="Oriente",6,
if_else(df$REG_SOCIOECONOM[index]=="Sureste",7,8)))))))
}
df1 <- df %>% select(PO2SM,IM,INFRA_INDEX,NUM_OPS,PEN_BAF_COAXFO,DENS_HOGS, REG_SOCIOECONOM)
df1$PO2SM<- as.numeric(df1$PO2SM)
df1$REG_SOCIOECONOM<- as.numeric(df1$REG_SOCIOECONOM)
cov(df1)
summary(df)
summary(hogares2015$HOGARES)
library(readr)
library(tidyverse)
library(readxl)
# Establece directorio de trabajo
setwd("/media/Box/Aprendizaje_Maquina/Projecto")
# Crear las bases de datos para trabajar
source("creating_baf.R") # Accesos de banda ancha fija a junio/2019 BIT del IFT
source("creating_conapo.R") # Indice marginacion y porcentaje pob con menos de 2 salarios min, 2015 CONAPO
source("creating_inafed.R") # Superficie de municipios, INAFED
source("creating_indiceinfraestructura.R")  # Indice infraestructura TII - centro de estudios IFT
source("creating_hogares.R") # Hogares por municipios Encuesta intercensal 2015, INEGI
source("creating_poblacion.R") # Poblacion por municipios Encuesta intercensal 2015, INEGI
# Elimina variables auxiliares
rm(index, left_path,name_state,right_path,states_list,cleaning_hog_state,cleaning_pop_state)
# Consolidamos las bases
df <- left_join(hogares2015,poblacion2015, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,conapo, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,INAFED, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,infraestructura_index, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,BAF_062019, by = "K_ENTIDAD_MUNICIPIO")
# Se eliminan columas sin interes para el analisis
df$K_ENTIDAD<-NULL
df$K_MUNICIPIO<-NULL
df$ANIO<-NULL
df$MES<-NULL
## El detalle de accesos a nivel municipal con NA se imputa con cero
df <- df %>% mutate_all(~replace(., is.na(.), 0))
summary(df)
# Crea variable de penetracion de BAF por cada 100 hogares y la penetracion de cable coaxial + fibra optica
df <- df %>% mutate(PEN_BAF = df$ALL_ACCESS/df$HOGARES*100)
df$PEN_BAF_COAXFO <- 0
for (i in 1:nrow(df)){
df$PEN_BAF_COAXFO[i]<- df$COAX_FO[i]/df$HOGARES[i]*100
}
# Crea variable de densidad de hogares por kilometros cuadrados
df <- df %>% mutate(DENS_HOGS = df$HOGARES/df$SUPERFICIE)
min(df$DENS_HOGS)
summary(df$DENS_HOGS)
df1<- df %>%  select(IM,INFRA_INDEX,NUM_OPS,PEN_BAF_COAXFO,DENS_HOGS)
summary(df1$DENS_HOGS)
df$DENS_HOGS <- 0
for (i in 1:nrow(df)){
df$DENS_HOGS[i]<- df$HOGARES[i]/df$SUPERFICIE[i]*100
}
df$DENS_HOGS <- 0
for (i in 1:nrow(df)){
df$DENS_HOGS[i]<- df$HOGARES[i]/df$SUPERFICIE[i]*100
}
summary(df$DENS_HOGS)
summary(df$SUPERFICIE)
View(INAFED)
summary(INAFED$SUPERFICIE)
is.na(INAFED$SUPERFICIE)
sum(abs(is.na(INAFED$SUPERFICIE)))
library(readr)
library(tidyverse)
library(readxl)
# Establece directorio de trabajo
setwd("/media/Box/Aprendizaje_Maquina/Projecto")
# Crear las bases de datos para trabajar
source("creating_baf.R") # Accesos de banda ancha fija a junio/2019 BIT del IFT
source("creating_conapo.R") # Indice marginacion y porcentaje pob con menos de 2 salarios min, 2015 CONAPO
source("creating_inafed.R") # Superficie de municipios, INAFED
source("creating_indiceinfraestructura.R")  # Indice infraestructura TII - centro de estudios IFT
source("creating_hogares.R") # Hogares por municipios Encuesta intercensal 2015, INEGI
source("creating_poblacion.R") # Poblacion por municipios Encuesta intercensal 2015, INEGI
# Elimina variables auxiliares
rm(index, left_path,name_state,right_path,states_list,cleaning_hog_state,cleaning_pop_state)
# Consolidamos las bases
df <- left_join(hogares2015,poblacion2015, by = "K_ENTIDAD_MUNICIPIO")
summary(df)
sum(abs(is.na(df$HOGARES)))
df <- left_join(df,conapo, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,INAFED, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,infraestructura_index, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,BAF_062019, by = "K_ENTIDAD_MUNICIPIO")
sum(abs(is.na(df$SUPERFICIE)))
de<-data.frame("07036","48.24") # Ver http://inafed.gob.mx/work/enciclopedia/EMM07chiapas/municipios/07036a.html
names(de)<-c("K_ENTIDAD_MUNICIPIO","SUPERFICIE")
INAFED <- rbind(INAFED,de)
View(INAFED)
de<-data.frame("23010","20.1") # Ver https://es.wikipedia.org/wiki/Municipio_de_Bacalar
names(de)<-c("K_ENTIDAD_MUNICIPIO","SUPERFICIE")
INAFED <- rbind(INAFED,de)
View(INAFED)
library(readr)
library(tidyverse)
library(readxl)
# Establece directorio de trabajo
setwd("/media/Box/Aprendizaje_Maquina/Projecto")
# Crear las bases de datos para trabajar
source("creating_baf.R") # Accesos de banda ancha fija a junio/2019 BIT del IFT
source("creating_conapo.R") # Indice marginacion y porcentaje pob con menos de 2 salarios min, 2015 CONAPO
source("creating_inafed.R") # Superficie de municipios, INAFED
source("creating_indiceinfraestructura.R")  # Indice infraestructura TII - centro de estudios IFT
source("creating_hogares.R") # Hogares por municipios Encuesta intercensal 2015, INEGI
source("creating_poblacion.R") # Poblacion por municipios Encuesta intercensal 2015, INEGI
# Elimina variables auxiliares
rm(index, left_path,name_state,right_path,states_list,cleaning_hog_state,cleaning_pop_state)
# Consolidamos las bases
df <- left_join(hogares2015,poblacion2015, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,conapo, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,INAFED, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,infraestructura_index, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,BAF_062019, by = "K_ENTIDAD_MUNICIPIO")
# Se eliminan columas sin interes para el analisis
df$K_ENTIDAD<-NULL
df$K_MUNICIPIO<-NULL
df$ANIO<-NULL
df$MES<-NULL
## El detalle de accesos a nivel municipal con NA se imputa con cero
df <- df %>% mutate_all(~replace(., is.na(.), 0))
# Crea variable de penetracion de BAF por cada 100 hogares y la penetracion de cable coaxial + fibra optica
df <- df %>% mutate(PEN_BAF = df$ALL_ACCESS/df$HOGARES*100)
df$PEN_BAF_COAXFO <- 0
for (i in 1:nrow(df)){
df$PEN_BAF_COAXFO[i]<- df$COAX_FO[i]/df$HOGARES[i]*100
}
# Crea variable de densidad de hogares por kilometros cuadrados
#df <- df %>% mutate(DENS_HOGS = df$HOGARES/df$SUPERFICIE)
df$DENS_HOGS <- 0
for (i in 1:nrow(df)){
df$DENS_HOGS[i]<- df$HOGARES[i]/df$SUPERFICIE[i]*100
}
# Creamos una columna para clasificar los municipios segun su grado de penetracion.
#La clasificación de Penetracion de Fibra Óptica y Cable Coaxial:
# Sin cobertura=0
# Muy baja 0>25%
# Baja 25%>50%
# Media 50%>75%
# Alta 75%>100%
# Muy Alta 100%
df$PEN_CLASS <- NA
for (index in 1:nrow(df)){
df$PEN_CLASS[index] <- if_else(df$PEN_BAF_COAXFO[index]==0,0,
if_else(df$PEN_BAF_COAXFO[index]<=25,1,
if_else(df$PEN_BAF_COAXFO[index]<=50,2,
if_else(df$PEN_BAF_COAXFO[index]<=75,3,
if_else(df$PEN_BAF_COAXFO[index]<=100,4,5)))))
}
#----- Agregamos una columna que nos diga la region socioecnomica a la que pertenece el municipio
RegionesSocioEcono <- read_csv("RegionesSocioEcono.csv",
col_types = cols(NOM_ABRE_ENTIDAD = col_skip(),
NOM_ENTIDAD = col_skip(), NUM = col_skip()))
df <- df %>% mutate(K_ENTIDAD = substr(K_ENTIDAD_MUNICIPIO,1,2))
df <- left_join(df,RegionesSocioEcono, by = "K_ENTIDAD")
df$K_ENTIDAD<-NULL
for (index in 1:nrow(df)){
df$REG_SOCIOECONOM[index] <- if_else(df$REG_SOCIOECONOM[index]=="Centronorte",1,
if_else(df$REG_SOCIOECONOM[index]=="Centrosur",2,
if_else(df$REG_SOCIOECONOM[index]=="Noreste",3,
if_else(df$REG_SOCIOECONOM[index]=="Noroeste",4,
if_else(df$REG_SOCIOECONOM[index]=="Occidente",5,
if_else(df$REG_SOCIOECONOM[index]=="Oriente",6,
if_else(df$REG_SOCIOECONOM[index]=="Sureste",7,8)))))))
}
df1 <- df %>% select(PO2SM,IM,INFRA_INDEX,NUM_OPS,PEN_BAF_COAXFO,DENS_HOGS,REG_SOCIOECONOM)
df$REG_SOCIOECONOM<-as.numeric(df$REG_SOCIOECONOM)
df1$PO2SM<-as.numeric(df1$PO2SM)
cov(df1)
glimpse(df1)
df1$REG_SOCIOECONOM<- as.numeric(df1$REG_SOCIOECONOM)
cov(df1)
summary(df1$DENS_HOGS)
df$DENS_HOGS <- 0
for (i in 1:nrow(df)){
df$DENS_HOGS[i]<- df$HOGARES[i]/df$SUPERFICIE[i]*100
}
df$DENS_HOGS <- 0
for (i in 1:nrow(df)){
df$DENS_HOGS[i]<- df$HOGARES[i]/df$SUPERFICIE[i]*100
}
df$HOGARES[1]/df$SUPERFICIE[1]
glimpse(df)
df$SUPERFICIE<- as.numeric(df$SUPERFICIE)
df$DENS_HOGS <- 0
for (i in 1:nrow(df)){
df$DENS_HOGS[i]<- df$HOGARES[i]/df$SUPERFICIE[i]*100
}
df1 <- df %>% select(PO2SM,IM,INFRA_INDEX,NUM_OPS,PEN_BAF_COAXFO,DENS_HOGS,REG_SOCIOECONOM)
df1$PO2SM<- as.numeric(df1$PO2SM)
df1$REG_SOCIOECONOM<- as.numeric(df1$REG_SOCIOECONOM)
cov(df1)
df1.pca <- prcomp(df1, center = TRUE,scale. = TRUE)
summary(df1.pca)
library(ggbiplot)
ggbiplot(df1.pca)
df1 <- df %>% select(PO2SM,IM,INFRA_INDEX,NUM_OPS,PEN_BAF_COAXFO,DENS_HOGS)
df1.pca <- prcomp(df1, center = TRUE,scale. = TRUE)
df1<- as.numeric(df1)
df1$PO2SM<- as.numeric(df1$PO2SM)
df1.pca <- prcomp(df1, center = TRUE,scale. = TRUE)
summary(df1.pca)
ggbiplot(df1.pca)
df %>% select_if(x, is.numeric) %>% prcomp(, center = TRUE,scale. = TRUE) %>% summary()
df1 <- df %>% select_if(x, is.numeric)
df %>% select_if(is.numeric) %>% prcomp(, center = TRUE,scale. = TRUE) %>% summary()
d1| %>%  select_if(is.numeric)
df1 %>%  select_if(is.numeric)
df %>%  select_if(is.numeric)
df1<-df %>%  select_if(is.numeric)
df1.pca <- prcomp(df1, center = TRUE,scale. = TRUE)
summary(df1.pca)
