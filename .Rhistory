setwd("~/Desktop/BandaAnchaFija")
knitr::opts_chunk$set(echo = TRUE)
library("readxl")
library("tidyverse")
library("readr")
library(leaflet) # Libreria para invocar la funcion colorNumeric de paleta de colores
library(mxmaps) #Ver https://www.diegovalle.net/mxmaps/
library(viridis) # Libreria para paleta de colores
library(scales) # Libreria auxiliar para colores
hogares2015<- read_csv("data/processed/hogares2015.csv")
setwd("/Users/czammar/Desktop/BandaAnchaFija/")
hogares2015<- read_csv("data/processed/hogares2015.csv")
setwd('/Users/czammar/Desktop/BandaAnchaFija/')
hogares2015<- read_csv("data/processed/hogares2015.csv")
hogares2015<- read_csv("../data/processed/hogares2015.csv")
hogares2015<- read_csv("../data/processed/hogares2015.csv")
poblacion2015<- read_csv("../data/processed/poblacion2015.csv")
BAF_062019 <- read_csv("../data/processed/BAF_062019.csv")
# Cargamos la base de datos de nombre de estados y municipios para usarla en los mapas
Nombres <- read_csv("data/Nombres_entidad_municipio.csv", locale = locale(encoding = "ISO-8859-1"))
# Cargamos la base de datos de nombre de estados y municipios para usarla en los mapas
Nombres <- read_csv("../data/Nombres_entidad_municipio.csv", locale = locale(encoding = "ISO-8859-1"))
Nombres <- Nombres %>% select(K_ENTIDAD_MUNICIPIO,nom_ent,nom_mun)
# Consolidamos las bases
df <- left_join(hogares2015,poblacion2015, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,BAF_062019, by = "K_ENTIDAD_MUNICIPIO")
df <- left_join(df,Nombres, by = "K_ENTIDAD_MUNICIPIO")
# Imputamos ceros donde no hay datos de penetracion
df <- df %>% mutate_all(~replace(., is.na(.), 0))
# Elimina variables auxiliares
rm(left_path,name_state,right_path,states_list,cleaning_hog_state,cleaning_pop_state, hogares2015,poblacion2015, BAF_062019, INAFED)
# Seleccionamos variables de interes y creamos otras
df <- df %>% select(K_ENTIDAD_MUNICIPIO, K_ENTIDAD, K_MUNICIPIO,nom_ent, nom_mun, HOGARES, POBLACION, ALL_ACCESS, COAX_FO)
df <- df %>% mutate(PEN_BAF_HOGS = 100*COAX_FO/HOGARES) # Penetracion por cada 100 hogares
df <- df %>% mutate(PEN_BAF_HABS = 100*COAX_FO/POBLACION) # Penetracion por cada 100 hogares
# Agregamos una columna que nos diga la region socioecnomica a la que pertenece el municipio
RegionesSocioEcono <- read_csv("../data/RegionesSocioEcono.csv",
col_types = cols(NOM_ABRE_ENTIDAD = col_skip(),
NOM_ENTIDAD = col_skip(), NUM = col_skip()))
df <- df %>% mutate(K_ENTIDAD = substr(K_ENTIDAD_MUNICIPIO,1,2))
df <- left_join(df,RegionesSocioEcono, by = "K_ENTIDAD")
for (index in 1:nrow(df)){
df$REG_SOCIOECONOM[index] <- if_else(df$REG_SOCIOECONOM[index]=="Centronorte",1,
if_else(df$REG_SOCIOECONOM[index]=="Centrosur",2,
if_else(df$REG_SOCIOECONOM[index]=="Noreste",3,
if_else(df$REG_SOCIOECONOM[index]=="Noroeste",4,
if_else(df$REG_SOCIOECONOM[index]=="Occidente",5,
if_else(df$REG_SOCIOECONOM[index]=="Oriente",6,
if_else(df$REG_SOCIOECONOM[index]=="Sureste",7,8)))))))
}
# Creamos una variable para hacer mapas de penetracion de cable coaxial y fibra optica
PenetrationBAF_Habitantes <- df
# Crea nombres de columnas value y region que se necesita para usan alimentar la funciÃ³n mxmunicipio_choropleth
PenetrationBAF_Habitantes$value <- PenetrationBAF_Habitantes$PEN_BAF_HABS # Valores para escala de colores
PenetrationBAF_Habitantes$region <- PenetrationBAF_Habitantes$K_ENTIDAD_MUNICIPIO # Llave principal de municipios de INEGI
# # Variable auxiliar para escala de colores de num_colors
Idx= 8
PenetrationBAF <- PenetrationBAF_Habitantes
# # Nota: se hace uso de la funcion zoom para crear un filtro con el nombre del estado (columna nom_ent)
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Aguascalientes"))$region,
title = "Aguascalientes - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
# # Nota: se hace uso de la funcion zoom para crear un filtro con el nombre del estado (columna nom_ent)
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Aguascalientes"))$region,
title = "Aguascalientes - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Baja California"))$region,
title = "Baja California - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Baja California Sur"))$region,
title = "Baja California Sur- Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Campeche"))$region,
title = "Campeche - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Coahuila de Zaragoza"))$region,
title = "Coahuila - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Colima"))$region,
title = "Colima - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Chiapas"))$region,
title = "Chiapas - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Chihuahua"))$region,
title = "Chihuahua - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Distrito Federal"))$region,
title = "CDMX - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx-4,
zoom = subset(PenetrationBAF,nom_ent %in% c("Distrito Federal"))$region,
title = "CDMX - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx-4,
zoom = subset(PenetrationBAF,nom_ent %in% c("Distrito Federal"))$region,
title = "CDMX - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Chihuahua"))$region,
title = "Chihuahua - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Chihuahua"))$region,
title = "Chihuahua - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
# # Nota: se hace uso de la funcion zoom para crear un filtro con el nombre del estado (columna nom_ent)
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Aguascalientes"))$region,
title = "Aguascalientes - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Baja California"))$region,
title = "Baja California - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Baja California Sur"))$region,
title = "Baja California Sur- Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Campeche"))$region,
title = "Campeche - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Coahuila de Zaragoza"))$region,
title = "Coahuila - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Colima"))$region,
title = "Colima - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Chiapas"))$region,
title = "Chiapas - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Chihuahua"))$region,
title = "Chihuahua - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Distrito Federal"))$region,
title = "CDMX - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Campeche"))$region,
title = "Campeche - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Coahuila de Zaragoza"))$region,
title = "Coahuila - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Colima"))$region,
title = "Colima - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Chiapas"))$region,
title = "Chiapas - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Chihuahua"))$region,
title = "Chihuahua - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Distrito Federal"))$region,
title = "CDMX - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = 4,
zoom = subset(PenetrationBAF,nom_ent %in% c("Distrito Federal"))$region,
title = "CDMX - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = 1,
zoom = subset(PenetrationBAF,nom_ent %in% c("Distrito Federal"))$region,
title = "CDMX - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF,
zoom = subset(PenetrationBAF,nom_ent %in% c("Distrito Federal"))$region,
title = "CDMX - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = 5,
zoom = subset(PenetrationBAF,nom_ent %in% c("Distrito Federal"))$region,
title = "CDMX - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Durango"))$region,
title = "Durango - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Guanajuato"))$region,
title = "Guanajuato - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Guerrero"))$region,
title = "Guerrero - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Hidalgo"))$region,
title = "Hidalgo - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Jalisco"))$region,
title = "Jalisco - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("MÃ©xico"))$region,
title = "Estado de MÃ©xico - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("MichoacÃ¡n de Ocampo"))$region,
title = "MichoacÃ¡n - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Morelos"))$region,
title = "Morelos - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Nayarit"))$region,
title = "Nayarit - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Nuevo LeÃ³n"))$region,
title = "Nuevo LeÃ³n - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Oaxaca"))$region,
title = "Oaxaca - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Puebla"))$region,
title = "Puebla - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("QuerÃ©taro"))$region,
title = "QuerÃ©taro - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = 2,
zoom = subset(PenetrationBAF,nom_ent %in% c("QuerÃ©taro"))$region,
title = "QuerÃ©taro - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = 1,
zoom = subset(PenetrationBAF,nom_ent %in% c("QuerÃ©taro"))$region,
title = "QuerÃ©taro - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Quintana Roo"))$region,
title = "Quintana Roo - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("San Luis PotosÃ­"))$region,
title = "San Luis PotosÃ­ - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Sinaloa"))$region,
title = "Sinaloa - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Sonora"))$region,
title = "Sonora - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Tabasco"))$region,
title = "Tabasco - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Tamaulipas"))$region,
title = "Tamaulipas - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Tlaxcala"))$region,
title = "Tlaxcala - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Veracruz de Ignacio de la Llave"))$region,
title = "Veracruz - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("YucatÃ¡n"))$region,
title = "YucatÃ¡n - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Zacatecas"))$region,
title = "Zacatecas - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = 1,
zoom = subset(PenetrationBAF,nom_ent %in% c("QuerÃ©taro"))$region,
title = "QuerÃ©taro - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
View(PenetrationBAF)
mxmunicipio_choropleth(PenetrationBAF, num_colors = 2,
zoom = subset(PenetrationBAF,nom_ent %in% c("QuerÃ©taro"))$region,
title = "QuerÃ©taro - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
View(PenetrationBAF)
mxmunicipio_choropleth(PenetrationBAF, num_colors = 2,
zoom = subset(PenetrationBAF,nom_ent %in% c("QuerÃ©taro de Arteaga"))$region,
title = "QuerÃ©taro - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("QuerÃ©taro de Arteaga"))$region,
title = "QuerÃ©taro - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
mxmunicipio_choropleth(PenetrationBAF, num_colors = 5,
zoom = subset(PenetrationBAF,nom_ent %in% c("Ciudad de MÃ©xico"))$region,
title = "CDMX - Accesos para servicios fijos de Internet por cada 100 hogares",
legend = "Accesos por \n cada 100 hogares")
# # Nota: se hace uso de la funcion zoom para crear un filtro con el nombre del estado (columna nom_ent)
# Region Noroeste
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Baja California", "Baja California Sur", "Chihuahua", "Durango", "Sinaloa", "Sonora"))$region,
title = "Accesos para servicios fijos de Internet por cada 100 hogares \n RegiÃ³n Noroeste (Baja California, Baja California Sur, \n Chihuahua, Durango, Sinaloa y Sonora )",
show_states = TRUE,
legend = "Accesos por \n cada 100 hogares")
# Region Noroeste
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Coahuila de Zaragoza", "Nuevo LeÃ³n", "Tamaulipas"))$region,
title = "Accesos para servicios fijos de Internet por cada 100 hogares \n RegiÃ³n Noreste (Coahuila, Nuevo LeÃ³n y Tamaulipas) ",
show_states = TRUE,
legend = "Accesos por \n cada 100 hogares")
# Region Occidente
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Colima", "Jalisco", "MichoacÃ¡n de Ocampo", "Nayarit"))$region,
title = "Accesos para servicios fijos de Internet por cada 100 hogares \n RegiÃ³n Occidente (Colima, Jalisco, MichoacÃ¡n y Nayarit)",
show_states = TRUE,
legend = "Accesos por \n cada 100 hogares")
# Region Oriente
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Hidalgo", "Puebla", "Tlaxcala", "Veracruz de Ignacio de la Llave"))$region,
title = "Accesos para servicios fijos de Internet por cada 100 hogares \n RegiÃ³n Oriente (Hidalgo, Puebla, Tlaxcala y Veracruz)",
show_states = TRUE,
legend = "Accesos por \n cada 100 hogares")
# Region Centronorte
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Aguascalientes", "Guanajuato", "QuerÃ©taro de Arteaga", "San Luis PotosÃ­", "Zacatecas"))$region,
title = "Accesos para servicios fijos de Internet por cada 100 hogares \n RegiÃ³n Centronorte (Aguascalientes, Guanajuato, QuerÃ©taro, \n San Luis PotosÃ­ y Zacatecas)",
show_states = TRUE,
legend = "Accesos por \n cada 100 hogares")
# Region Centrosur
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("MÃ©xico", "Ciudad de MÃ©xico", "Morelos"))$region,
title = "Accesos para servicios fijos de Internet por cada 100 hogares \n Region Centrosur (CDMX, Estado de MÃ©xico y Morelos)",
show_states = TRUE,
legend = "Accesos por \n cada 100 hogares")
# Region Suroeste
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Chiapas", "Guerrero", "Oaxaca"))$region,
title = "Accesos para servicios fijos de Internet por cada 100 hogares \n RegiÃ³n Suroeste (Chiapas, Guerrero y Oaxaca) ",
show_states = TRUE,
legend = "Accesos por \n cada 100 hogares")
# Region Sureste
mxmunicipio_choropleth(PenetrationBAF, num_colors = Idx,
zoom = subset(PenetrationBAF,nom_ent %in% c("Campeche", "Quintana Roo", "Tabasco", "YucatÃ¡n"))$region,
title = "Accesos para servicios fijos de Internet por cada 100 hogares \n RegiÃ³n Sureste (Campeche, Tabasco, Quintana Roo y YucatÃ¡n)",
show_states = TRUE,
legend = "Accesos por \n cada 100 hogares")
knitr::opts_chunk$set(echo = TRUE)
library("readxl")
library("tidyverse")
library("readr")
library(leaflet) # Libreria para invocar la funcion colorNumeric de paleta de colores
library(mxmaps) #Ver https://www.diegovalle.net/mxmaps/
library(viridis) # Libreria para paleta de colores
library(scales) # Libreria auxiliar para colores
########## Mapa dinamico de penetracion por cada 100 hogares en todos los municpios de mexico ##########
# Creamos una variable para hacer mapas de penetracion de cable coaxial y fibra optica
PenetrationBAF_Hogares <- df
# Crea nombres de columnas value y region que se necesita para usan alimentar la funciÃ³n mxmunicipio_choropleth
PenetrationBAF_Hogares$value <- PenetrationBAF_Hogares$PEN_BAF_HOGS # Valores para escala de colores
PenetrationBAF_Hogares$region <- PenetrationBAF_Hogares$K_ENTIDAD_MUNICIPIO # Llave principal de municipios de INEGI
# Definicion de paleta de colores a partir de valores de penetracion
# "RdYlBu", "Accent", or "Greens"
#"viridis", "magma", "inferno", or "plasma".
# Spectral para el mapa de BAF para hogares
pal <- colorNumeric(palette = "magma", domain = PenetrationBAF_Hogares$value)
mxmunicipio_leaflet(PenetrationBAF_Hogares,
pal,
~ pal(value),
~ sprintf("Estado: %s<br/>Municipio : %s<br/>PenetraciÃ³n: %s ",
nom_ent, nom_mun, round(value,1))) %>%
addLegend(position = "topright",
pal = pal,
values = PenetrationBAF_Hogares$value,
title = "Accesos de cable coaxial y fibra <br/>  Ã³ptica por cada 100 hogares",
labFormat = labelFormat(suffix = "",
transform = function(x) {x})) %>%
addProviderTiles("CartoDB.Positron")
